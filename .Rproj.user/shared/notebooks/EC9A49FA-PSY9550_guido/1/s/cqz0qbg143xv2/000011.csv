"0","# producing dataset"
"0","N <- 200 # number of grandparent-parent-child triads "
"0","b_GP <- 1 # direct effect of G on P "
"0","b_GC <- 0 # direct effect of G on C "
"0","b_PC <- 1 # direct effect of P on C "
"0","b_U <- 2 # direct effect of U on P and C"
"0",""
"0",""
"0","set.seed(1) "
"0","U <- 2*rbern( N , 0.5 ) - 1 "
"0","G <- rnorm( N ) "
"0","P <- rnorm( N , b_GP*G + b_U*U ) "
"0","C <- rnorm( N , b_PC*P + b_GC*G + b_U*U ) "
"0","d <- data.frame( C=C , P=P , G=G , U=U )"
"0",""
"0",""
"0","# the model, now with U"
"0","m6.12 <- quap( "
"0","  alist( C ~ dnorm( mu , sigma ), "
"0","         mu <- a + b_PC*P + b_GC*G + b_U*U, "
"0","         a ~ dnorm( 0 , 1 ), "
"0","         c(b_PC,b_GC,b_U) ~ dnorm( 0 , 1 ), "
"0","         sigma ~ dexp( 1 ) ), data=d ) "
"0","precis(m6.12)"
