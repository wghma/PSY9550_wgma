"0",""
"0","# This function "
"0","single_sim <- function(tosses, prior_type = c(""uniform"", ""step"")) {"
"0","  prior_type <- match.arg(prior_type)"
"0","  obs <- rbinom(1, size = tosses, prob = 0.7)"
"0","  "
"0","  p_grid <- seq(from = 0, to = 1, length.out = 1000)"
"0","  prior <- rep(1, 1000)"
"0","  if (prior_type == ""step"") prior[1:500] <- 0"
"0","  "
"0","  likelihood <- dbinom(obs, size = tosses, prob = p_grid)"
"0","  posterior <- likelihood * prior"
"0","  posterior <- posterior / sum(posterior)"
"0","  "
"0","  samples <- sample(p_grid, prob = posterior, size = 1e4, replace = TRUE)"
"0","  interval <- PI(samples, prob = 0.99)"
"0","  width <- interval[2] - interval[1]"
"0","}"
"0",""
"0",""
"0","single_cond <- function(tosses, prior_type, reps = 100) {"
"0","  tibble(tosses = tosses,"
"0","         prior_type = prior_type,"
"0","         width = map_dbl(seq_len(reps), ~single_sim(tosses = tosses,"
"0","                                                    prior_type = prior_type)))"
"0","}"
"0",""
"0","simulation <- crossing(tosses = seq(1000, 5000, by = 100),"
"0","                       prior_type = c(""uniform"", ""step"")) %>%"
"0","  pmap_dfr(single_cond, reps = 100) %>%"
"0","  group_by(tosses, prior_type) %>%"
"0","  summarize(avg_width = mean(width), .groups = ""drop"") %>%"
"0","  mutate(prior_type = case_when(prior_type == ""uniform"" ~ ""Uniform Prior"","
"0","                                prior_type == ""step"" ~ ""Step Prior""),"
"0","         prior_type = factor(prior_type, levels = c(""Uniform Prior"","
"0","                                                    ""Step Prior"")))"
"0",""
"0","ggplot(simulation, aes(x = tosses, y = avg_width)) +"
"0","  facet_wrap(~prior_type, nrow = 1) +"
"0","  geom_point() +"
"0","  geom_line() +"
"0","  # scale_x_comma() +"
"0","  labs(x = ""Tosses"", y = ""Average Interval Width"") +"
"0","  theme(panel.spacing.x = unit(2, ""lines""))"
