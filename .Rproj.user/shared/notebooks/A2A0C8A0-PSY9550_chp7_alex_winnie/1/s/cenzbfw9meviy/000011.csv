"0",""
"0","#earlier function code that is reused in this example."
"0","p_logp <- function(p) {"
"0","  if (p == 0) return(0)"
"0","  p * log(p)"
"0","}"
"0","calc_entropy <- function(x) {"
"0","  avg_logprob <- sum(map_dbl(x, p_logp))"
"0","  -1 * avg_logprob"
"0","}"
"0",""
"0",""
"0","# setting up island data"
"0","islands <- tibble(island = paste(""Island"", 1:3),"
"0","       a = c(0.2, 0.8, 0.05),"
"0","       b = c(0.2, 0.1, 0.15),"
"0","       c = c(0.2, 0.05, 0.7),"
"0","       d = c(0.2, 0.025, 0.05),"
"0","       e = c(0.2, 0.025, 0.05)) %>%"
"0","  pivot_longer(-island, names_to = ""species"", values_to = ""prop"")"
"0",""
"0","islands %>%"
"0","  group_by(island) %>%"
"0","  summarize(prop = list(prop), .groups = ""drop"") %>%"
"0","  mutate(entropy = map_dbl(prop, calc_entropy))"
